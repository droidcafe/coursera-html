<html>
  <head>
    <title>Matching Game - Part 4</title>
    </head>

  <body onload="generate()">
  <style>
      #rightSide{
        position: absolute;
        left: 50%;
        border-left: 1px solid black;
    }
    div{
      position: absolute;
      height: 500px;
      width: 500px;
    }
    img{
      position: absolute;
    }
  </style>
    <h2>Matching Game</h2>
    <p>Click on the extra smiling face on the left</p>
    <div id="leftSide"></div>
    <div id="rightSide"></div>

    <script>
    var theBody = document.getElementsByTagName("body")[0];
    var theLeftSide = document.getElementById('leftSide');
    var theRightSide = document.getElementById('rightSide');
    var numberOfFaces = 0;

    theBody.onclick = function onFailure() {
      alert('Game Over');
      theBody.onclick = null;
      theLeftSide.lastChild.onclick = null;
    }

    function generateFaces(){
      for (var i = 0; i < numberOfFaces; i++) {
        var image_node = getPic();
        theLeftSide.appendChild(image_node);
      }
      var images = theLeftSide.cloneNode(true);
      images.removeChild(images.lastChild);
      theRightSide.appendChild(images);

      theLeftSide.lastChild.onclick = function success(event) {
         event.stopPropagation();
         generate();
      }
    }

    function generate() {
      numberOfFaces += 5;
      while (theLeftSide.firstChild) {
        theLeftSide.removeChild(theLeftSide.firstChild);
      }
      while (theRightSide.firstChild) {
        theRightSide.removeChild(theRightSide.firstChild);
      }
      generateFaces();
    }

    function getPic() {
      var image_node = document.createElement('img');
      image_node.src = 'http://home.cse.ust.hk/~rossiter/mooc/matching_game/smile.png';
      var left = Math.floor(Math.random () * 400);
      var top = Math.floor(Math.random () * 380) + 20;
      image_node.style.left = left+"px";
      image_node.style.top = top+"px";

      return image_node;
    }

    </script>

</body>
</html>
